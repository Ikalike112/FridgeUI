@model IEnumerable<FridgeUI.Models.FridgeModels.FridgeDto>

@{
    ViewData["Title"] = "Index";
}

<h1>Fridges</h1>

<p>
    <a asp-action="Create">Create New</a>
</p>
<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.OwnerName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FridgeModelName)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                    @Html.HiddenFor(modelItem => item.Id)
                <td>
                    @Html.DisplayFor(modelItem => item.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.OwnerName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.FridgeModelName)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Update", new { id=item.Id  }, new {@class="btn btn-link nopadding"}) |
                    @Html.ActionLink("Details", "Products", "FridgeProducts", new { id=item.Id  }, new {@class="btn btn-link nopadding"}) |
                    <input type="button" value="Delete" class="btn btn-link nopadding" onclick="deleteConfirm('@item.Id')" />
                </td>
            </tr>
        }
    </tbody>
</table>
<style>

</style>

@section Scripts{
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="text/javascript">
        var deleteConfirm = function (val) {
            Swal.fire({
                title: 'Do you want to save the changes?',
                showCancelButton: true,
                confirmButtonText: 'Save',
            }).then((result) => {
                if (result.isConfirmed) {
                    deleteData(val);
                }
            })
        }
        var deleteData = function (val) {
            $.ajax({
                type: "DELETE",
                url: '@Url.Action("Delete","Fridge")',
                data: { Id: val },
                success: function (result) {
                    window.location.href = result;
                },
                error: function () {
                    $("#delete-conformation").modal('hide');
                }
            });
        }
    </script>
}